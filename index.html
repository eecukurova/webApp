<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EralpAhmet Trading Company</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="config.js"></script>
  <!-- Google Sign-In API -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <!-- reCAPTCHA API -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body class="text-gray-800 bg-gray-50 scroll-smooth">

  <!-- ğŸ§± Header -->
  <header class="bg-white shadow-md fixed w-full z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <div class="text-xl font-bold text-indigo-600">EralpAhmet Trading Co.</div>
      <nav class="space-x-6 hidden md:flex items-center">
        <a href="#hero" class="hover:text-indigo-500 font-medium">Ana Sayfa</a>
        <a href="#strategies" class="hover:text-indigo-500 font-medium">Stratejiler</a>
        <a href="#request" class="hover:text-indigo-500 font-medium">Strateji Talebi</a>
        <a href="#contact" class="hover:text-indigo-500 font-medium">Ä°letiÅŸim</a>
        <a href="#" onclick="openAdminModal()" class="hover:text-indigo-500 font-medium">Admin</a>
        
        <!-- Authentication buttons -->
        <div id="authButtons" class="ml-4">
          <button id="loginBtn" onclick="openLoginModal()" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition">
            GiriÅŸ Yap
          </button>
          <div id="userInfo" class="hidden">
            <span id="userName" class="text-indigo-600 font-medium mr-2"></span>
            <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">
              Ã‡Ä±kÄ±ÅŸ Yap
            </button>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- ğŸ” Login Modal -->
  <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">GiriÅŸ Yap</h2>
        <button onclick="closeLoginModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <form id="loginForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">E-posta</label>
          <input type="email" id="loginEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Åifre</label>
          <input type="password" id="loginPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
        </div>
        
        <!-- reCAPTCHA -->
        <div id="recaptchaContainer" class="g-recaptcha"></div>
        
        <!-- Test User Info -->
        <div class="bg-blue-50 border border-blue-200 rounded-md p-3">
          <p class="text-sm text-blue-700">
            <strong>Test HesabÄ±:</strong><br>
            KullanÄ±cÄ± AdÄ±: <code class="bg-blue-100 px-1 rounded">testuser</code><br>
            Åifre: <code class="bg-blue-100 px-1 rounded">testuser</code>
          </p>
        </div>
        
        <div class="space-y-3">
          <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition">
            GiriÅŸ Yap
          </button>
          
          <div class="text-center">
            <span class="text-gray-500">veya</span>
          </div>
          
          <!-- Google Sign-In Button -->
          <div id="googleSignInButton" class="flex justify-center"></div>
        </div>
      </form>
    </div>
  </div>

  <!-- ğŸ‘¨â€ğŸ’¼ Admin Login Modal -->
  <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Admin GiriÅŸi</h2>
        <button onclick="closeAdminModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <form id="adminLoginForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">KullanÄ±cÄ± AdÄ±</label>
          <input type="text" id="adminUsername" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Åifre</label>
          <input type="password" id="adminPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
        </div>
        
        <button type="submit" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition">
          Admin GiriÅŸi
        </button>
      </form>
    </div>
  </div>

  <!-- ğŸ›ï¸ Admin Panel -->
  <div id="adminPanel" class="fixed inset-0 bg-white hidden z-50 overflow-y-auto">
    <div class="bg-gray-900 text-white p-4">
      <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold">Admin Panel - Ticket Sistemi</h1>
        <button onclick="closeAdminPanel()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">
          Ã‡Ä±kÄ±ÅŸ Yap
        </button>
      </div>
    </div>
    
    <div class="p-6">
      <!-- Ticket Statistics -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-blue-100 p-4 rounded-lg">
          <h3 class="text-lg font-semibold text-blue-800">AÃ§Ä±k Talepler</h3>
          <p class="text-3xl font-bold text-blue-600" id="openTickets">0</p>
        </div>
        <div class="bg-yellow-100 p-4 rounded-lg">
          <h3 class="text-lg font-semibold text-yellow-800">Devam Eden</h3>
          <p class="text-3xl font-bold text-yellow-600" id="inProgressTickets">0</p>
        </div>
        <div class="bg-green-100 p-4 rounded-lg">
          <h3 class="text-lg font-semibold text-green-800">KapalÄ± Talepler</h3>
          <p class="text-3xl font-bold text-green-600" id="closedTickets">0</p>
        </div>
      </div>
      
      <!-- Ticket List -->
      <div class="bg-white rounded-lg shadow">
        <div class="p-4 border-b border-gray-200">
          <h2 class="text-xl font-semibold">Strateji Talepleri</h2>
        </div>
        
        <div id="ticketList" class="p-4">
          <!-- Tickets will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- ğŸ« Ticket Detail Modal -->
  <div id="ticketDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Ticket DetayÄ±</h2>
        <button onclick="closeTicketDetail()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <div id="ticketDetailContent">
        <!-- Ticket details will be populated here -->
      </div>
    </div>
  </div>

  <!-- ğŸ  Hero Section -->
  <section id="hero" class="min-h-screen flex items-center justify-center pt-20 px-4 relative" style="background-image: url('./fotos/ana_sayfa.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
    <!-- Background overlay for better text readability -->
    <div class="absolute inset-0 bg-black bg-opacity-40"></div>
    
    <div class="text-center max-w-2xl relative z-10">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 text-white drop-shadow-lg">Profesyonel Stratejilerle Ticaretinizi GeliÅŸtirin</h1>
      <p class="text-lg md:text-xl mb-6 text-white drop-shadow-md">BaÅŸarÄ±nÄ±z iÃ§in Ã¶zel olarak tasarlanmÄ±ÅŸ gÃ¼Ã§lÃ¼ TradingView scriptleri geliÅŸtiriyoruz.</p>
      <a href="#strategies" class="inline-block bg-indigo-600 text-white px-6 py-3 rounded-lg shadow hover:bg-indigo-700 transition">Stratejileri KeÅŸfedin</a>
    </div>
  </section>

  <!-- ğŸ“ˆ Strategies Section -->
  <section id="strategies" class="py-16 bg-white px-4">
    <div class="max-w-7xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-12">Ã–ne Ã‡Ä±kan Stratejilerimiz</h2>
      <div class="grid md:grid-cols-2 gap-8">
        
        <!-- Strategy 1 -->
        <div class="bg-gray-100 rounded-lg shadow p-6">
          <h3 class="text-2xl font-semibold mb-4">PSAR Strategy</h3>
          <img src="fotos/psar_strateji.png" alt="PSAR Strategy Chart" class="rounded mb-4 w-full">
          <p class="mb-4">PSAR ATR Stratejisi, Parabolic SAR ve Average True Range (ATR) gÃ¶stergelerini birleÅŸtiren geliÅŸmiÅŸ bir momentum tabanlÄ± trading stratejisidir. Bu strateji, trend yÃ¶nÃ¼nÃ¼ belirlemek iÃ§in PSAR noktalarÄ±nÄ± kullanÄ±rken, ATR ile volatilite bazlÄ± stop-loss ve take-profit seviyeleri belirler. Ã–zellikle gÃ¼Ã§lÃ¼ trendlerde yÃ¼ksek kazanÃ§ potansiyeli sunar ve ani fiyat hareketlerine karÅŸÄ± koruma saÄŸlar. Strateji, 15 dakikalÄ±k timeframe'de Ã§alÄ±ÅŸarak hem kÄ±sa vadeli fÄ±rsatlarÄ± yakalar hem de trend devam ederken pozisyonlarÄ± korur.</p>
          <button class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">SatÄ±n Al</button>
        </div>

        <!-- Strategy 2 -->
        <div class="bg-gray-100 rounded-lg shadow p-6">
          <h3 class="text-2xl font-semibold mb-4">ATR Strategy</h3>
          <img src="fotos/atr_strateji.png" alt="ATR Strategy Chart" class="rounded mb-4 w-full">
          <p class="mb-4">ATR Stratejisi, Average True Range gÃ¶stergesine dayalÄ± volatilite odaklÄ± bir trading yaklaÅŸÄ±mÄ±dÄ±r. Bu strateji, piyasa volatilitesini analiz ederek optimal giriÅŸ ve Ã§Ä±kÄ±ÅŸ noktalarÄ±nÄ± belirler. ATR deÄŸerlerine gÃ¶re dinamik stop-loss seviyeleri ayarlar ve risk yÃ¶netimini volatilite bazlÄ± yapar. Strateji, dÃ¼ÅŸÃ¼k volatilite dÃ¶nemlerinde daha konservatif, yÃ¼ksek volatilite dÃ¶nemlerinde ise daha agresif pozisyonlar alÄ±r. Bu yaklaÅŸÄ±m, piyasa koÅŸullarÄ±na adapte olarak tutarlÄ± performans saÄŸlar.</p>
          <button class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">SatÄ±n Al</button>
        </div>

      </div>
    </div>
  </section>

  <!-- ğŸŒŸ Premium Content Section -->
  <section id="premiumContent" class="hidden py-16 bg-gradient-to-r from-indigo-600 to-purple-600">
    <div class="max-w-7xl mx-auto px-4 text-center text-white">
      <h2 class="text-3xl font-bold mb-4">ğŸ‰ Premium Ãœye AvantajlarÄ±nÄ±z</h2>
      <p class="text-xl mb-8">GiriÅŸ yaptÄ±ÄŸÄ±nÄ±z iÃ§in Ã¶zel indirimler ve avantajlar sizi bekliyor!</p>
      
      <div class="grid md:grid-cols-3 gap-8 mb-8">
        <div class="bg-white bg-opacity-20 p-6 rounded-lg">
          <h3 class="text-xl font-semibold mb-2">ğŸ“ˆ Ãœcretsiz Analiz</h3>
          <p>KiÅŸisel trading analizi ve strateji Ã¶nerileri</p>
        </div>
        <div class="bg-white bg-opacity-20 p-6 rounded-lg">
          <h3 class="text-xl font-semibold mb-2">ğŸ’° %20 Ä°ndirim</h3>
          <p>TÃ¼m stratejilerde Ã¶zel Ã¼ye indirimi</p>
        </div>
        <div class="bg-white bg-opacity-20 p-6 rounded-lg">
          <h3 class="text-xl font-semibold mb-2">ğŸ¯ Ã–ncelikli Destek</h3>
          <p>7/24 Ã¶ncelikli teknik destek hizmeti</p>
        </div>
      </div>
      
      <p class="text-lg">HoÅŸgeldiniz <span id="premiumUserName" class="font-bold"></span>! ğŸš€</p>
    </div>
  </section>

  <!-- ğŸ§¾ Request Custom Strategy Section -->
  <section id="request" class="py-16 bg-gray-50 px-4">
    <div class="max-w-2xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-4">Strateji Talebi</h2>
      <p class="text-center mb-8">Hangi stratejimizi satÄ±n almak istiyorsunuz? AÅŸaÄŸÄ±daki formu doldurarak talebinizi iletebilirsiniz. Uzman ekibimiz en kÄ±sa sÃ¼rede sizinle iletiÅŸime geÃ§ecektir.</p>
      
      <!-- Login Required Message -->
      <div id="loginRequiredMessage" class="hidden bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-6 text-center">
        <p class="mb-2">Strateji talebi iÃ§in giriÅŸ yapmanÄ±z gerekiyor.</p>
        <button onclick="openLoginModal()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded transition">
          GiriÅŸ Yap
        </button>
      </div>
      
      <form id="strategyForm" onsubmit="handleFormSubmit(event)" class="space-y-6 bg-white p-6 rounded-lg shadow">
        <div>
          <label class="block mb-1 font-medium">Ä°sim</label>
          <input type="text" id="name" class="w-full border border-gray-300 rounded px-4 py-2" required />
        </div>
        <div>
          <label class="block mb-1 font-medium">E-posta</label>
          <input type="email" id="email" class="w-full border border-gray-300 rounded px-4 py-2" required />
        </div>
        <div>
          <label class="block mb-1 font-medium">TradingView KullanÄ±cÄ± AdÄ±</label>
          <input type="text" id="tradingViewUsername" class="w-full border border-gray-300 rounded px-4 py-2" required />
        </div>
        <div>
          <label class="block mb-1 font-medium">Ä°stediÄŸiniz Strateji</label>
          <select id="selectedStrategy" class="w-full border border-gray-300 rounded px-4 py-2" required>
            <option value="">Bir strateji seÃ§in</option>
          </select>
        </div>
        <div>
          <label class="block mb-1 font-medium">Not YazÄ±nÄ±z</label>
          <textarea id="notes" class="w-full border border-gray-300 rounded px-4 py-2" rows="4" placeholder="Ek bilgi veya Ã¶zel talepleriniz varsa buraya yazabilirsiniz..."></textarea>
        </div>
        <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Talep GÃ¶nder</button>
      </form>
    </div>
  </section>

  <!-- ğŸ“¬ Contact Section (Footer) -->
  <footer id="contact" class="bg-white py-12 border-t">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <h3 class="text-2xl font-semibold mb-4">Ä°letiÅŸim</h3>
      <p class="mb-2">E-posta: <a href="mailto:info@eralpahmettrading.com" class="text-indigo-600 hover:underline">info@eralpahmettrading.com</a></p>
      <div class="flex justify-center space-x-6 mt-4 text-xl">
        <a href="#" class="hover:text-indigo-500" title="Telegram">ğŸ“¨</a>
        <a href="#" class="hover:text-indigo-500" title="Discord">ğŸ’¬</a>
      </div>
      <p class="mt-8 text-sm text-gray-500">Â© 2025 EralpAhmet Trading Company. TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
    </div>
  </footer>

  <script>
    // Global authentication state
    let isAuthenticated = false;
    let currentUser = null;

    // Initialize dropdown when page loads
    document.addEventListener('DOMContentLoaded', function() {
      populateStrategyDropdown();
      initializeAuth();
    });

    // Initialize authentication
    function initializeAuth() {
      // Initialize Google Sign-In
      google.accounts.id.initialize({
        client_id: config.auth.googleClientId,
        callback: handleGoogleSignIn
      });

      // Render Google Sign-In button
      google.accounts.id.renderButton(
        document.getElementById('googleSignInButton'),
        {
          theme: 'outline',
          size: 'large',
          text: 'continue_with',
          shape: 'rectangular',
          width: 250
        }
      );

      // Initialize reCAPTCHA
      if (typeof grecaptcha !== 'undefined') {
        grecaptcha.render('recaptchaContainer', {
          'sitekey': config.auth.recaptchaSiteKey
        });
      }

      // Check if user is already logged in
      checkAuthState();
    }

    // Check authentication state
    function checkAuthState() {
      const savedUser = localStorage.getItem('currentUser');
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        isAuthenticated = true;
        updateAuthUI();
      }
    }

    // Handle Google Sign-In
    function handleGoogleSignIn(response) {
      const credential = parseJwt(response.credential);
      
      currentUser = {
        id: credential.sub,
        name: credential.name,
        email: credential.email,
        picture: credential.picture,
        loginMethod: 'google',
        userType: 'google'
      };
      
      isAuthenticated = true;
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      updateAuthUI();
      closeLoginModal();
      
      // Show success message
      showMessage('BaÅŸarÄ±yla giriÅŸ yaptÄ±nÄ±z!', 'success');
    }

    // Parse JWT token
    function parseJwt(token) {
      const base64Url = token.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));
      return JSON.parse(jsonPayload);
    }

    // Regular login with email/password
    function handleRegularLogin(email, password) {
      // Verify reCAPTCHA
      const recaptchaResponse = grecaptcha.getResponse();
      if (!recaptchaResponse) {
        showMessage('LÃ¼tfen reCAPTCHA\'yÄ± tamamlayÄ±n.', 'error');
        return;
      }

      // Check test user credentials
      if (email === config.testUser.username && password === config.testUser.password) {
        currentUser = {
          id: 'testuser_' + Date.now(),
          name: 'Test KullanÄ±cÄ±sÄ±',
          email: 'testuser@example.com',
          picture: null,
          loginMethod: 'testuser',
          userType: 'test'
        };
        
        isAuthenticated = true;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        updateAuthUI();
        closeLoginModal();
        
        showMessage('Test kullanÄ±cÄ±sÄ± olarak giriÅŸ yaptÄ±nÄ±z!', 'success');
        return;
      }

      // Demo authentication for email format (in real app, this would be server-side)
      if (email && password && email.includes('@')) {
        currentUser = {
          id: Date.now().toString(),
          name: email.split('@')[0],
          email: email,
          picture: null,
          loginMethod: 'email',
          userType: 'regular'
        };
        
        isAuthenticated = true;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        updateAuthUI();
        closeLoginModal();
        
        showMessage('BaÅŸarÄ±yla giriÅŸ yaptÄ±nÄ±z!', 'success');
      } else {
        showMessage('GeÃ§ersiz kullanÄ±cÄ± adÄ± veya ÅŸifre!', 'error');
      }
    }

    // Login modal functions
    function openLoginModal() {
      document.getElementById('loginModal').classList.remove('hidden');
      // Reset reCAPTCHA
      if (typeof grecaptcha !== 'undefined') {
        grecaptcha.reset();
      }
    }

    function closeLoginModal() {
      document.getElementById('loginModal').classList.add('hidden');
      document.getElementById('loginForm').reset();
    }

    // Logout function
    function logout() {
      isAuthenticated = false;
      currentUser = null;
      localStorage.removeItem('currentUser');
      
      // Sign out from Google
      if (typeof google !== 'undefined') {
        google.accounts.id.disableAutoSelect();
      }
      
      updateAuthUI();
      showMessage('BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yaptÄ±nÄ±z.', 'success');
    }

    // Update authentication UI
    function updateAuthUI() {
      const loginBtn = document.getElementById('loginBtn');
      const userInfo = document.getElementById('userInfo');
      const userName = document.getElementById('userName');
      const loginRequiredMessage = document.getElementById('loginRequiredMessage');
      const strategyForm = document.getElementById('strategyForm');
      const premiumContent = document.getElementById('premiumContent');
      const premiumUserName = document.getElementById('premiumUserName');
      
      if (isAuthenticated && currentUser) {
        // Header authentication
        loginBtn.classList.add('hidden');
        userInfo.classList.remove('hidden');
        if (currentUser.userType === 'test') {
          userName.textContent = currentUser.name + ' (Test)';
        } else {
          userName.textContent = currentUser.name;
        }
        
        // Strategy form
        loginRequiredMessage.classList.add('hidden');
        strategyForm.classList.remove('hidden');
        
        // Premium content
        premiumContent.classList.remove('hidden');
        if (currentUser.userType === 'test') {
          premiumUserName.textContent = currentUser.name + ' (Test KullanÄ±cÄ±sÄ±)';
        } else {
          premiumUserName.textContent = currentUser.name;
        }
      } else {
        // Header authentication
        loginBtn.classList.remove('hidden');
        userInfo.classList.add('hidden');
        userName.textContent = '';
        
        // Strategy form
        loginRequiredMessage.classList.remove('hidden');
        strategyForm.classList.add('hidden');
        
        // Premium content
        premiumContent.classList.add('hidden');
        premiumUserName.textContent = '';
      }
    }

    // Show message function
    function showMessage(message, type) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
        type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
      }`;
      messageDiv.textContent = message;
      
      document.body.appendChild(messageDiv);
      
      setTimeout(() => {
        messageDiv.remove();
      }, 3000);
    }

    // Handle login form submission
    document.addEventListener('DOMContentLoaded', function() {
      const loginForm = document.getElementById('loginForm');
      loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        handleRegularLogin(email, password);
      });
    });

    // Populate strategy dropdown from config
    function populateStrategyDropdown() {
      const select = document.getElementById('selectedStrategy');
      config.strategies.forEach(strategy => {
        const option = document.createElement('option');
        option.value = strategy;
        option.textContent = strategy;
        select.appendChild(option);
      });
    }

    // Handle form submission
    function handleFormSubmit(event) {
      event.preventDefault();
      
      // Check if user is logged in
      if (!isAuthenticated) {
        showMessage('Strateji talebi iÃ§in giriÅŸ yapmanÄ±z gerekiyor.', 'error');
        openLoginModal();
        return;
      }
      
      const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        tradingViewUsername: document.getElementById('tradingViewUsername').value,
        selectedStrategy: document.getElementById('selectedStrategy').value,
        notes: document.getElementById('notes').value
      };

      // Send email
      sendEmail(formData);
    }

    // Send email function
    function sendEmail(data) {
      // Create ticket
      const ticket = {
        id: Date.now(),
        name: data.name,
        email: data.email,
        tradingViewUsername: data.tradingViewUsername,
        selectedStrategy: data.selectedStrategy,
        notes: data.notes,
        status: 'open',
        createdAt: new Date().toISOString(),
        responses: []
      };

      // Save ticket to localStorage
      let tickets = JSON.parse(localStorage.getItem('tickets') || '[]');
      tickets.push(ticket);
      localStorage.setItem('tickets', JSON.stringify(tickets));

      const subject = encodeURIComponent(config.email.subject);
      const body = encodeURIComponent(
        `Yeni Strateji Talebi DetaylarÄ±:\n\n` +
        `Ticket ID: ${ticket.id}\n` +
        `Ä°sim: ${data.name}\n` +
        `E-posta: ${data.email}\n` +
        `TradingView KullanÄ±cÄ± AdÄ±: ${data.tradingViewUsername}\n` +
        `Ä°stenen Strateji: ${data.selectedStrategy}\n` +
        `Notlar: ${data.notes}\n\n` +
        `Talep Tarihi: ${new Date().toLocaleString('tr-TR')}`
      );

      // Open email client with pre-filled data
      const mailtoLink = `mailto:${config.email.recipient}?subject=${subject}&body=${body}`;
      window.location.href = mailtoLink;

      // Show success message
      showMessage(`Talebiniz alÄ±ndÄ±! Ticket ID: ${ticket.id}. E-posta istemciniz aÃ§Ä±lacak.`, 'success');
      
      // Reset form
      document.getElementById('strategyForm').reset();
    }

    // ======= ADMIN PANEL FUNCTIONS =======
    
    // Admin state
    let isAdminLoggedIn = false;
    let currentTickets = [];

    // Open admin modal
    function openAdminModal() {
      document.getElementById('adminModal').classList.remove('hidden');
    }

    // Close admin modal
    function closeAdminModal() {
      document.getElementById('adminModal').classList.add('hidden');
      document.getElementById('adminLoginForm').reset();
    }

    // Admin login
    function handleAdminLogin(username, password) {
      if (username === config.admin.username && password === config.admin.password) {
        isAdminLoggedIn = true;
        closeAdminModal();
        showAdminPanel();
        showMessage('Admin giriÅŸi baÅŸarÄ±lÄ±!', 'success');
      } else {
        showMessage('KullanÄ±cÄ± adÄ± veya ÅŸifre hatalÄ±!', 'error');
      }
    }

    // Show admin panel
    function showAdminPanel() {
      document.getElementById('adminPanel').classList.remove('hidden');
      loadTickets();
      updateTicketStatistics();
    }

    // Close admin panel
    function closeAdminPanel() {
      document.getElementById('adminPanel').classList.add('hidden');
      isAdminLoggedIn = false;
      showMessage('Admin Ã§Ä±kÄ±ÅŸÄ± yapÄ±ldÄ±.', 'success');
    }

    // Load tickets from localStorage
    function loadTickets() {
      currentTickets = JSON.parse(localStorage.getItem('tickets') || '[]');
      displayTickets();
    }

    // Display tickets in admin panel
    function displayTickets() {
      const ticketList = document.getElementById('ticketList');
      
      if (currentTickets.length === 0) {
        ticketList.innerHTML = '<p class="text-gray-500 text-center py-4">HenÃ¼z hiÃ§ strateji talebi yok.</p>';
        return;
      }

      ticketList.innerHTML = currentTickets.map(ticket => {
        const statusColors = {
          'open': 'bg-blue-100 text-blue-800',
          'inprogress': 'bg-yellow-100 text-yellow-800',
          'closed': 'bg-green-100 text-green-800'
        };

        const statusTexts = {
          'open': 'AÃ§Ä±k',
          'inprogress': 'Devam Ediyor',
          'closed': 'KapalÄ±'
        };

        return `
          <div class="border border-gray-200 rounded-lg p-4 mb-4 hover:shadow-md transition">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <h3 class="font-semibold text-lg">Ticket #${ticket.id}</h3>
                <p class="text-gray-600">ğŸ‘¤ ${ticket.name} (${ticket.email})</p>
                <p class="text-gray-600">ğŸ“ˆ ${ticket.selectedStrategy}</p>
                <p class="text-gray-500 text-sm">ğŸ“… ${new Date(ticket.createdAt).toLocaleString('tr-TR')}</p>
              </div>
              <div class="flex flex-col items-end space-y-2">
                <span class="px-3 py-1 rounded-full text-xs font-medium ${statusColors[ticket.status]}">
                  ${statusTexts[ticket.status]}
                </span>
                <button onclick="showTicketDetail(${ticket.id})" class="bg-indigo-600 text-white px-3 py-1 rounded text-sm hover:bg-indigo-700">
                  DetaylarÄ± GÃ¶rÃ¼ntÃ¼le
                </button>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // Show ticket detail
    function showTicketDetail(ticketId) {
      const ticket = currentTickets.find(t => t.id === ticketId);
      if (!ticket) return;

      const statusOptions = [
        { value: 'open', text: 'AÃ§Ä±k' },
        { value: 'inprogress', text: 'Devam Ediyor' },
        { value: 'closed', text: 'KapalÄ±' }
      ];

      const statusSelect = statusOptions.map(option => 
        `<option value="${option.value}" ${ticket.status === option.value ? 'selected' : ''}>${option.text}</option>`
      ).join('');

      const responsesHtml = ticket.responses.map(response => `
        <div class="bg-gray-50 p-3 rounded mb-2">
          <p class="text-sm text-gray-600">ğŸ“… ${new Date(response.timestamp).toLocaleString('tr-TR')}</p>
          <p class="mt-1">${response.message}</p>
        </div>
      `).join('');

      document.getElementById('ticketDetailContent').innerHTML = `
        <div class="space-y-4">
          <div class="bg-gray-50 p-4 rounded-lg">
            <h3 class="font-semibold mb-2">Ticket Bilgileri</h3>
            <p><strong>ID:</strong> ${ticket.id}</p>
            <p><strong>Ä°sim:</strong> ${ticket.name}</p>
            <p><strong>E-posta:</strong> ${ticket.email}</p>
            <p><strong>TradingView:</strong> ${ticket.tradingViewUsername}</p>
            <p><strong>Ä°stenen Strateji:</strong> ${ticket.selectedStrategy}</p>
            <p><strong>Tarih:</strong> ${new Date(ticket.createdAt).toLocaleString('tr-TR')}</p>
            <p><strong>Notlar:</strong> ${ticket.notes || 'Yok'}</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Ticket Durumu</label>
            <select id="ticketStatus" class="w-full px-3 py-2 border border-gray-300 rounded-md">
              ${statusSelect}
            </select>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Cevaplar</label>
            <div class="max-h-60 overflow-y-auto">
              ${responsesHtml || '<p class="text-gray-500">HenÃ¼z cevap yok.</p>'}
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Yeni Cevap</label>
            <textarea id="newResponse" class="w-full px-3 py-2 border border-gray-300 rounded-md" rows="3" placeholder="CevabÄ±nÄ±zÄ± yazÄ±n..."></textarea>
          </div>

          <div class="flex space-x-3">
            <button onclick="updateTicketStatus(${ticket.id})" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
              Durumu GÃ¼ncelle
            </button>
            <button onclick="addResponse(${ticket.id})" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
              Cevap Ekle
            </button>
          </div>
        </div>
      `;

      document.getElementById('ticketDetailModal').classList.remove('hidden');
    }

    // Close ticket detail
    function closeTicketDetail() {
      document.getElementById('ticketDetailModal').classList.add('hidden');
    }

    // Update ticket status
    function updateTicketStatus(ticketId) {
      const newStatus = document.getElementById('ticketStatus').value;
      
      // Update in currentTickets array
      const ticket = currentTickets.find(t => t.id === ticketId);
      if (ticket) {
        ticket.status = newStatus;
        
        // Update localStorage
        localStorage.setItem('tickets', JSON.stringify(currentTickets));
        
        // Refresh displays
        displayTickets();
        updateTicketStatistics();
        
        showMessage('Ticket durumu gÃ¼ncellendi!', 'success');
      }
    }

    // Add response to ticket
    function addResponse(ticketId) {
      const responseText = document.getElementById('newResponse').value.trim();
      if (!responseText) {
        showMessage('Cevap boÅŸ olamaz!', 'error');
        return;
      }

      const ticket = currentTickets.find(t => t.id === ticketId);
      if (ticket) {
        ticket.responses.push({
          message: responseText,
          timestamp: new Date().toISOString()
        });

        // Update localStorage
        localStorage.setItem('tickets', JSON.stringify(currentTickets));
        
        // Refresh ticket detail
        showTicketDetail(ticketId);
        
        showMessage('Cevap eklendi!', 'success');
      }
    }

    // Update ticket statistics
    function updateTicketStatistics() {
      const stats = {
        open: currentTickets.filter(t => t.status === 'open').length,
        inprogress: currentTickets.filter(t => t.status === 'inprogress').length,
        closed: currentTickets.filter(t => t.status === 'closed').length
      };

      document.getElementById('openTickets').textContent = stats.open;
      document.getElementById('inProgressTickets').textContent = stats.inprogress;
      document.getElementById('closedTickets').textContent = stats.closed;
    }

    // Admin form submission
    document.addEventListener('DOMContentLoaded', function() {
      const adminLoginForm = document.getElementById('adminLoginForm');
      adminLoginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('adminUsername').value;
        const password = document.getElementById('adminPassword').value;
        handleAdminLogin(username, password);
      });
    });
  </script>

</body>
</html> 